---
import BuscarIcon from "./Icons/Buscar.astro";
---

<div id="barra-busqueda-contenedor" class="hidden mb-6 sm:ml-64">
    <form class="max-w-xl mx-auto">
        <label
            for="search"
            class="block mb-2.5 text-sm font-medium text-heading sr-only"
            >Search</label
        >
        <div class="relative">
            <div
                class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none"
            >
                <BuscarIcon class="size-5" />
            </div>
            <input
                type="search"
                id="search-input-field"
                class="block w-full p-3 ps-9 bg-neutral-secondary-medium border border-default-medium text-heading text-sm rounded-base focus:ring-brand focus:border-brand shadow-xs placeholder:text-body"
                placeholder="Search"
                required
            />
            <button
                type="button"
                class="absolute end-1.5 bottom-1.5 text-white bg-brand hover:bg-brand-strong box-border border border-transparent focus:ring-4 focus:ring-brand-medium shadow-xs font-medium leading-5 rounded text-xs px-3 py-1.5 focus:outline-none"
                >Search</button
            >
        </div>
    </form>
</div>

<script>
    // 1. Obtenemos los elementos
    const botonBuscar = document.getElementById("boton-activar-busqueda");
    const contenedorBusqueda = document.getElementById(
        "barra-busqueda-contenedor",
    );
    const campoBusqueda = document.getElementById("search-input-field"); // <--- Aún es potencialmente null aquí

    // 2. Verificamos que *todos* los elementos existan antes de agregar el listener
    if (botonBuscar && contenedorBusqueda && campoBusqueda) {
        // <--- CAMBIO CLAVE

        // 3. Agregamos el "escuchador" del evento click
        botonBuscar.addEventListener("click", () => {
            // 4. Alternamos la clase 'hidden'
            contenedorBusqueda.classList.toggle("hidden");

            // Ahora, campoBusqueda está garantizado de NO ser null dentro de este IF
            if (!contenedorBusqueda.classList.contains("hidden")) {
                campoBusqueda.focus();
            }
        });
    }
</script>
